# Issue #18 過去の実績データに基づく要約時間推定の実装

## 実装概要
ユーザーからの要望「要約の想定時間は文字起こしの数や出力の文字数によって異なるため、過去の要約にかかった時間をもとに算出する」に対応しました。

## 主な変更内容

### 1. 過去データに基づく推定ロジックの実装（src/server.ts）
新しい関数`calculateAverageSummaryTime`を追加：
- 同じGPTモデルで処理された過去の履歴から平均処理時間を計算
- 最低3件のサンプルが必要（信頼性確保のため）
- 10件以上のサンプルがある場合は外れ値（上位・下位10%）を除外
- 動画の長さに対する処理時間の比率を計算し、平均化

### 2. 推定時間計算の改善（src/server.ts）
`calculateProcessingTime`関数を更新：
- まず過去データからの推定を試みる
- 十分なデータがない場合はデフォルトの係数を使用
- `isHistoricalEstimate`フラグで推定方法を識別

### 3. UIでの表示改善（src/components/pages/AnalyzePage.tsx）
- 過去データから算出した場合、「過去の実績から算出」バッジを表示
- 緑色の背景で視覚的に区別

### 4. 型定義の更新（src/types/index.ts）
- `estimatedProcessingTime`に`isHistoricalEstimate`フィールドを追加

## 技術的詳細

### データサンプル要件
- **最小サンプル数**: 3件（統計的信頼性の最低ライン）
- **外れ値除外**: 10件以上で適用（上位・下位10%を除外）

### 計算方法
1. 各履歴エントリから「要約時間÷動画時間」の比率を計算
2. 外れ値を除外（サンプル数が十分な場合）
3. 平均比率を計算
4. 新しい動画の長さに平均比率を適用

### フォールバック
過去データが不足している場合は、従来通りのデフォルト係数を使用：
- GPT-4o-mini: 0.5
- GPT-4o: 0.4
- GPT-4-turbo: 0.3
- GPT-4: 0.25

## 効果
- より正確な処理時間推定が可能に
- 実際の処理パフォーマンスを反映
- データが蓄積されるほど精度が向上